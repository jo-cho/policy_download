from selenium.webdriver.common.by import By
import time
from tqdm import tqdm
import pandas as pd
from selenium import webdriver
num_list = ['0000187845', '0000187631', '0000187628', '0000187622', '0000187553', '0000187509', '0000187508', '0000187505', '0000187453', '0000187446', '0000187412', '0000187410', '0000187355', '0000187320', '0000187113', '0000187030', '0000187025', '0000186997', '0000186876', '0000186862', '0000186841', '0000186574', '0000186570', '0000186535', '0000186534', '0000186527', '0000186429', '0000186427', '0000186343', '0000186305', '0000186299', '0000186250', '0000186205', '0000186202', '0000186200', '0000186121', '0000186037', '0000185976', '0000185951', '0000185938', '0000185758', '0000185728', '0000185602', '0000185522', '0000185437', '0000185400', '0000185399', '0000185393', '0000185271', '0000185260', '0000185233', '0000185189', '0000185039', '0000185037', '0000185029', '0000184974', '0000184893', '0000184892', '0000184858', '0000184780', '0000184765', '0000184728', '0000184727', '0000184726', '0000184722', '0000184721', '0000184680', '0000184635', '0000184599', '0000184587', '0000184550', '0000184457', '0000184418', '0000184365', '0000184331', '0000184286', '0000184254', '0000184203', '0000184201', '0000184099', '0000184061', '0000183876', '0000183831', '0000183751', '0000183667', '0000183663', '0000183624', '0000183549', '0000183398', '0000183397', '0000183358', '0000183257', '0000183215', '0000183214', '0000183173', '0000183130', '0000183093', '0000183090', '0000183055', '0000183021', '0000182987', '0000182984', '0000182978', '0000182977', '0000182898', '0000182895', '0000182855', '0000182853', '0000182749', '0000182731', '0000182694', '0000182693', '0000182643', '0000182608', '0000182590', '0000182558', '0000182400', '0000182396', '0000182361', '0000182323', '0000182322', '0000182002', '0000182000', '0000181999', '0000181950', '0000181945', '0000181941', '0000181906', '0000181883', '0000181852', '0000181796', '0000181720', '0000181680', '0000181649', '0000181606', '0000181595', '0000181594', '0000181395', '0000181389', '0000181376', '0000181342', '0000181316', '0000181315', '0000181304', '0000181267', '0000181264', '0000181261', '0000181149', '0000181018', '0000180959', '0000180958', '0000180942', '0000180938', '0000180933', '0000180932', '0000180897', '0000180894', '0000180798', '0000180743', '0000180648', '0000180647', '0000180642', '0000180605', '0000180569', '0000180516', '0000180478', '0000180397', '0000180209', '0000180207', '0000180108', '0000180070', '0000180058', '0000179986', '0000179973', '0000179963', '0000179930', '0000179832', '0000179831', '0000179778', '0000179764', '0000179418', '0000179381', '0000179380', '0000179379', '0000179104', '0000179049', '0000179048', '0000179029', '0000178901', '0000178896', '0000178801', '0000178799', '0000178763', '0000178727', '0000178576', '0000178071', '0000177890', '0000177743', '0000177695', '0000177567', '0000177234', '0000177148', '0000177025', '0000176904', '0000176897', '0000176831', '0000176789', '0000176678', '0000176642', '0000176613', '0000176554', '0000176169', '0000176123', '0000176013', '0000175975', '0000175922', '0000175877', '0000175838', '0000175791', '0000175754', '0000175617', '0000175523', '0000175409', '0000175383', '0000175308', '0000175303', '0000175239', '0000174507', '0000174402', '0000174400', '0000173722', '0000173556', '0000173528', '0000173526', '0000173360', '0000173301', '0000173148', '0000173119', '0000173010', '0000172782', '0000172753', '0000172638', '0000172635', '0000172550', '0000172549', '0000172442', '0000172355', '0000172238', '0000172177', '0000172016', '0000171637', '0000171489', '0000171417', '0000171349', '0000171320', '0000171315', '0000171004', '0000171003', '0000170936', '0000170720', '0000170680', '0000169964', '0000169645', '0000169641', '0000169584', '0000169403', '0000169390', '0000169244', '0000169142', '0000169141', '0000169140', '0000168943', '0000168938', '0000168927', '0000168890', '0000168889', '0000168635', '0000168497', '0000168375', '0000168374', '0000168365', '0000168296', '0000167911', '0000167777', '0000167694', '0000167450', '0000167415', '0000167409', '0000167331', '0000167300', '0000167297', '0000167132', '0000167026', '0000166840', '0000165713', '0000165651', '0000165633', '0000165573', '0000165473', '0000164925', '0000164908', '0000164832', '0000164766', '0000164698', '0000164656', '0000164652', '0000164500', '0000164497', '0000164489', '0000164445', '0000164416', '0000164399', '0000164394', '0000164381', '0000164374', '0000164364', '0000164360', '0000164337', '0000164160', '0000164060', '0000164049', '0000164031', '0000164018', '0000163960', '0000163902', '0000163824', '0000163568', '0000163524', '0000163474', '0000163447', '0000163152', '0000162953', '0000162741', '0000162738', '0000162596', '0000162571', '0000162535', '0000162533', '0000162205', '0000162133', '0000162090', '0000162008', '0000161986', '0000161811', '0000161796', '0000161750', '0000161443', '0000161442', '0000161441', '0000161322', '0000161282', '0000161243', '0000161139', '0000161136', '0000161058', '0000161010', '0000160980', '0000160973', '0000160971', '0000160970', '0000160952', '0000160879', '0000160873', '0000160861', '0000160860', '0000160811', '0000160807', '0000160774', '0000160745', '0000160743', '0000160731', '0000160727', '0000160670', '0000160652', '0000160494', '0000160490', '0000160466', '0000160411', '0000160394', '0000160374', '0000160345', '0000160334', '0000160217', '0000159994', '0000159917', '0000159844', '0000159843', '0000159671', '0000159336', '0000159228', '0000159141', '0000159110', '0000159058', '0000159029', '0000159028', '0000158769', '0000158768', '0000158763', '0000158645', '0000158584', '0000158509', '0000158399', '0000158360', '0000158224', '0000158089', '0000158018', '0000158017', '0000157883', '0000157801', '0000157731', '0000157594', '0000157556', '0000157469', '0000157468', '0000157289', '0000157287', '0000157148', '0000157101', '0000157067', '0000156990', '0000156945', '0000156786', '0000156756', '0000156651', '0000156545', '0000156217', '0000155880', '0000155701', '0000155634', '0000155631', '0000155621', '0000155618', '0000155581', '0000155503', '0000155502', '0000155443', '0000155423', '0000155279', '0000155278', '0000155157', '0000154959', '0000154599', '0000154561', '0000154273', '0000154061', '0000153981', '0000153967', '0000153821', '0000153583', '0000153513', '0000153388', '0000153369', '0000153311', '0000153271', '0000153081', '0000153046', '0000153023', '0000152939', '0000152920', '0000152507', '0000152506', '0000152400', '0000152141', '0000152059', '0000152014', '0000152012', '0000151875', '0000151820', '0000151765', '0000151575', '0000151536', '0000151407', '0000151312', '0000151261', '0000151152', '0000151104', '0000151015', '0000150961', '0000150954', '0000150801', '0000150764', '0000150635', '0000150521', '0000150461', '0000150424', '0000150411', '0000150356', '0000150329', '0000150326', '0000150293', '0000150274', '0000150262', '0000150242', '0000150236', '0000150233', '0000150232', '0000150180', '0000150164', '0000150087', '0000150085', '0000150065', '0000150028', '0000149994', '0000149990', '0000149946', '0000149915', '0000149710', '0000149708', '0000149681', '0000149679', '0000149649', '0000149617', '0000149552', '0000149472', '0000149470', '0000149439', '0000149312', '0000148977', '0000148959', '0000148908', '0000148825', '0000148777', '0000148636', '0000148602', '0000148482', '0000148435', '0000148434', '0000148301', '0000148014', '0000148013', '0000147823', '0000147787', '0000147690', '0000147689', '0000147498', '0000147478', '0000147415', '0000147383', '0000147365', '0000147203', '0000147181', '0000147067', '0000147051', '0000146856', '0000146791', '0000146775', '0000146740', '0000146613', '0000146597', '0000146547', '0000146531', '0000146528', '0000146527', '0000146478', '0000146461', '0000146391', '0000146372', '0000146283', '0000146206', '0000146191', '0000146142', '0000146121', '0000146055', '0000146042', '0000146039', '0000145871', '0000145780', '0000145726', '0000145688', '0000145650', '0000145633', '0000145581', '0000145496', '0000145481', '0000145460', '0000145446', '0000145442', '0000145354', '0000145341', '0000145170', '0000145117', '0000145059', '0000145042', '0000145008', '0000145005', '0000144956', '0000144920', '0000144856', '0000144674', '0000144660', '0000144542', '0000144522', '0000144470', '0000144453', '0000144253', '0000144136', '0000144013', '0000143933', '0000143811', '0000143794', '0000143702', '0000143688', '0000143539', '0000143508', '0000143305', '0000143273', '0000143230', '0000143228', '0000143217', '0000143120', '0000143108', '0000142958', '0000142940', '0000142894', '0000142789', '0000142729', '0000142666', '0000142586', '0000142434', '0000142226', '0000142166', '0000142120', '0000142013', '0000141721', '0000141715', '0000141609', '0000141530', '0000141529', '0000141281', '0000141259', '0000141092', '0000140912', '0000140880', '0000140713', '0000140710', '0000140618', '0000140616', '0000140429', '0000140375', '0000140367', '0000140245', '0000140098', '0000139946', '0000139797', '0000139795', '0000139781', '0000139646', '0000139563', '0000139549', '0000139464', '0000139382', '0000139245', '0000139214', '0000139188', '0000139045', '0000138982', '0000138918', '0000138915', '0000138913', '0000138822', '0000138682', '0000138679', '0000138570', '0000138550', '0000138531', '0000138514', '0000138174', '0000137760', '0000137753', '0000137734', '0000137726', '0000137701', '0000137696', '0000137671', '0000137661', '0000137596', '0000137583', '0000137375', '0000137368', '0000137228', '0000137100', '0000137056', '0000136979', '0000136955', '0000136909', '0000136884', '0000136862', '0000136861', '0000136853', '0000136786', '0000136755', '0000136662', '0000136650', '0000136616', '0000136598', '0000136568', '0000136561', '0000136366', '0000136240', '0000136228', '0000136227', '0000136225', '0000136208', '0000136207', '0000136206', '0000136205', '0000136204', '0000136185', '0000136184', '0000136171', '0000136152', '0000136050', '0000135974', '0000135891', '0000135869', '0000135777', '0000135715', '0000135698', '0000135697', '0000135440', '0000135287', '0000135163', '0000135050', '0000135030', '0000135029', '0000134972', '0000134803', '0000134730', '0000134712', '0000134620', '0000134574', '0000134310', '0000134112', '0000133984', '0000133937', '0000133869', '0000133866', '0000133556', '0000133534', '0000133505', '0000133431', '0000133429', '0000133222', '0000133118', '0000133116', '0000133093', '0000133090', '0000132994', '0000132934', '0000132933', '0000132908', '0000132882', '0000132660', '0000132640', '0000132545', '0000132533', '0000132414', '0000132167', '0000132129', '0000131898', '0000131877', '0000131165', '0000131041', '0000130924', '0000130830', '0000130782', '0000130769', '0000130703', '0000130653', '0000130530', '0000130266', '0000130263', '0000129989', '0000129927', '0000129756', '0000129648', '0000129601', '0000129573', '0000129504', '0000129255', '0000129254', '0000129231', '0000129125', '0000129051', '0000128993', '0000128664', '0000128539', '0000128536', '0000128463', '0000128216', '0000128136', '0000127741', '0000127652', '0000127330', '0000127247', '0000127148', '0000126980', '0000126725', '0000126568', '0000126542', '0000126449', '0000126436', '0000126366', '0000126319', '0000126245', '0000126193', '0000126034', '0000126010', '0000125812', '0000125685', '0000125587', '0000125487', '0000125223', '0000125002', '0000124814', '0000124751', '0000124716', '0000124667', '0000124613', '0000124562', '0000124482', '0000124450', '0000124086', '0000123836', '0000123779', '0000123744', '0000123564', '0000123522', '0000123512', '0000123451', '0000123379', '0000123366', '0000123199', '0000123089', '0000123023', '0000122422', '0000122224', '0000121764', '0000121661', '0000121649', '0000121371', '0000121336', '0000121123', '0000120783', '0000120663', '0000120614', '0000120523', '0000120441', '0000120413', '0000120372', '0000120199', '0000119828', '0000119707', '0000119663', '0000119534', '0000119508', '0000119414', '0000119210', '0000118915', '0000118887', '0000118791', '0000118665', '0000118630', '0000118598', '0000118512', '0000118456', '0000118232', '0000118167', '0000118130', '0000118103', '0000117895', '0000117845', '0000117815', '0000117678', '0000117667', '0000117571', '0000117482', '0000117384', '0000117266', '0000117003', '0000116911', '0000116661', '0000116640', '0000116413', '0000116383', '0000116339', '0000116315', '0000116067', '0000115805', '0000115741', '0000115460', '0000115396', '0000115204', '0000115166', '0000114943', '0000114841', '0000114643', '0000114336', '0000114067', '0000113872', '0000113706', '0000113495', '0000113202', '0000113092', '0000113022', '0000112447', '0000112192', '0000111693', '0000111648', '0000111434', '0000111299', '0000111138', '0000111127', '0000110901', '0000110823', '0000110231', '0000110190', '0000109632', '0000109396', '0000109174', '0000108676', '0000108610', '0000108373', '0000108339', '0000108059', '0000107800', '0000107668', '0000107422', '0000107262', '0000106971', '0000106207', '0000105993', '0000105877', '0000105739', '0000105596', '0000105405', '0000105254', '0000105204', '0000104853', '0000104593', '0000104203', '0000103437', '0000103360', '0000102811', '0000102612', '0000102393', '0000101973', '0000101948', '0000101696', '0000101413', '0000101379', '0000100258', '0000100180', '0000100057', '0000099944', '0000099916', '0000099747', '0000099369', '0000099322', '0000098976', '0000098951', '0000098006', '0000097643', '0000096856', '0000096840', '0000096694', '0000096174', '0000095987', '0000095643', '0000095571', '0000095569', '0000095562', '0000095431', '0000095379', '0000095377', '0000095304', '0000095285', '0000094421', '0000093881', '0000092464', '0000090515', '0000090247', '0000090070', '0000089427', '0000089001', '0000088745', '0000088743', '0000088387', '0000088140', '0000087034', '0000086697', '0000086217', '0000085955', '0000085437', '0000085270', '0000085029', '0000084822', '0000084821', '0000083183', '0000083061', '0000082242', '0000081834', '0000081706', '0000081559', '0000080607', '0000079831', '0000079698', '0000079293', '0000078633', '0000078170', '0000077988', '0000077841', '0000077358', '0000076990', '0000075871', '0000075381', '0000074989', '0000074047', '0000073711', '0000073462', '0000073341', '0000073120', '0000073104', '0000073015', '0000073009', '0000072966', '0000072539', '0000071617', '0000071582', '0000070752', '0000070008', '0000069976', '0000069407', '0000068801', '0000067588', '0000067536', '0000067489', '0000066839', '0000066689', '0000066303', '0000065791', '0000065663', '0000065467', '0000064874', '0000064791', '0000064168', '0000063982', '0000063888', '0000063788', '0000063784', '0000063527', '0000063402', '0000063243', '0000063242', '0000063239', '0000063228', '0000063220', '0000062914', '0000062337', '0000061793', '0000061781', '0000061635', '0000060579', '0000060351', '0000059692', '0000059498', '0000059144', '0000059003', '0000058792', '0000058558', '0000058014', '0000057790', '0000057606', '0000057526', '0000057525', '0000057524', '0000057523', '0000057522', '0000057521', '0000057455', '0000056643', '0000056017', '0000055850', '0000055195', '0000055160', '0000055136', '0000054714', '0000054712', '0000054710', '0000054709', '0000054708', '0000054707', '0000054706', '0000054705', '0000054704', '0000054703', '0000054700', '0000054699', '0000054608', '0000054607', '0000054606', '0000054605', '0000054603', '0000054602', '0000054601', '0000054600', '0000054598', '0000054597', '0000054594', '0000054593', '0000054592', '0000054591', '0000054590', '0000054547', '0000054312', '0000053289', '0000052868', '0000052856', '0000052476', '0000052339', '0000052286', '0000052283', '0000052209', '0000052089', '0000052070', '0000051755', '0000051215', '0000050962', '0000050339', '0000050102', '0000049534', '0000049533', '0000049532', '0000049528', '0000049526', '0000049525', '0000048750', '0000048728', '0000048727', '0000048583', '0000048533', '0000048505', '0000048504', '0000048503', '0000048502', '0000048501', '0000047949', '0000046922', '0000046188', '0000046041', '0000045642', '0000045638', '0000045248', '0000044523', '0000044522', '0000044521', '0000044520', '0000044519', '0000044517', '0000044516', '0000044512', '0000044510', '0000044267', '0000044148', '0000044147', '0000043908', '0000043905', '0000043904', '0000043903', '0000043901', '0000043899', '0000043898', '0000043896', '0000043374', '0000042620', '0000042465', '0000042315', '0000040783', '0000040761', '0000040654', '0000040402', '0000040290', '0000039789', '0000039192', '0000038872', '0000038816', '0000038774', '0000038355', '0000038350', '0000038345', '0000038045', '0000037683', '0000037068', '0000036308', '0000036020', '0000035896', '0000035712', '0000035050', '0000035049', '0000034926', '0000034770', '0000034665', '0000034652', '0000034605', '0000034604', '0000033593', '0000033592', '0000032995', '0000032759', '0000032757', '0000032670', '0000032358', '0000031949', '0000031907', '0000031901', '0000031470', '0000031469', '0000031279', '0000030719', '0000030718', '0000030635', '0000029218', '0000029213', '0000028761', '0000028547', '0000027798', '0000027796', '0000027177', '0000026962', '0000026893', '0000024987', '0000024327', '0000023579', '0000023561', '0000023272', '0000023261', '0000023259', '0000023258', '0000023255', '0000023253', '0000023252', '0000023251', '0000023249', '0000023248', '0000023241', '0000023239', '0000023236', '0000023235', '0000023232', '0000023227', '0000023225', '0000023219', '0000023218', '0000023215', '0000023211', '0000023209', '0000023201', '0000023199', '0000023195', '0000023194', '0000021787', '0000021308', '0000020702', '0000020645', '0000018440', '0000018437', '0000018436', '0000017904', '0000013840', '0000013315', '0000013310', '0000013303']

if __name__ == '__main__':
    driver = webdriver.Chrome()
    df_list = []
    for n in tqdm(num_list):
        url = f"https://eiec.kdi.re.kr/policy/domesticView.do?ac={n}"
        driver.get(url)
        # 제목 찾기
        title = driver.find_element(By.CSS_SELECTOR,
                                    '#ui_contents > div.page_conts-bar.economy_multi > div.view_comm_style > div.view_top.downbtn_org.css_pdright > strong').text
        # 날짜 찾기
        date = driver.find_element(By.CSS_SELECTOR,
                                   '#ui_contents > div.page_conts-bar.economy_multi > div.view_comm_style > div.view_top.downbtn_org.css_pdright > div > div.downbtn_line > span').text
        # 부처 찾기
        dept = driver.find_element(By.CSS_SELECTOR,
                                    '#ui_contents > div.page_conts-bar.economy_multi > div.view_comm_style > div.view_top.downbtn_org.css_pdright > div > span').text

        element = driver.find_element(By.CSS_SELECTOR, '#ui_contents > div.page_conts-bar.economy_multi > div.view_comm_style > div.view_top.downbtn_org.css_pdright > div > div.right > a')
        file_dn_link = element.get_attribute('href')


        df0 = pd.DataFrame({"자료명": title, "발간일": date, "발간처": dept, "페이지수": None, "URL": url,
                            "파일명1": None, "파일명2": None, "파일명3": None, "파일명4": None,
                            "파일명5": None,
                            "다운로드링크1": file_dn_link, "다운로드링크2": None, "다운로드링크3": None,
                            "다운로드링크4": None,
                            "다운로드링크5": None}, index=[n])
        df_list.append(df0)

    df = pd.concat(df_list, axis=0)
    print(df)
    df.to_excel("C:/Users/master/downloads/metadata_research.xlsx", engine='xlsxwriter')